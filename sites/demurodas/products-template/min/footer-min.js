window.location.href.includes("mode=")&&(document.getElementById("main").style.display="none",document.getElementById("pdfSelector").classList.contains("w-condition-invisible")?(document.querySelector(".portrait-pdf-wrapper").style.display="none",document.querySelector(".landscape-pdf-wrapper").style.display="flex"):(document.querySelector(".landscape-pdf-wrapper").style.display="none",document.querySelector(".portrait-pdf-wrapper").style.display="flex"),window.location.href.includes("mode=pdf")&&(document.querySelector(".pdf-page-2-wrapper").style.display="flex"));const priceHeading=document.getElementById("priceHeading"),price=document.getElementById("price"),downloadBtn=document.getElementById("download");firebase.auth().onAuthStateChanged(e=>{e?(console.log("user is authed"),getPricing(),setAuthedTearSheet(),downloadBtn.style.display="flex"):(console.log("user is not authed"),setPubTearSheet())});const getPricing=async()=>{price.innerHTML="Please contact us for pricing"},scripts=document.querySelectorAll(".w-json");let imgUrls=[];scripts.forEach(e=>{let t=JSON.parse(e.innerText);"product-p"===t.group&&imgUrls.push(t.items[0].url)});const downloadText=document.getElementById("downloadText"),downloadZip=async()=>{try{downloadBtn.removeEventListener("click",downloadZip),downloadText.innerText="Preparing download...";let e=await firebase.auth().currentUser.getIdToken(!0),t="";imgUrls.forEach(e=>{t+=encodeURIComponent(e)+","});let n=t.substr(0,t.length-1),l=`${createZipUrl}?urls=${n}&token=${e}`,d=await fetch(l),a=await d.blob(),o=document.getElementById("title").innerText;saveAs(a,o+".zip"),downloadText.innerHTML="Download all images",downloadBtn.addEventListener("click",downloadZip)}catch(i){Sentry.captureException(i),downloadText.innerHTML="Download all images",downloadBtn.addEventListener("click",downloadZip)}};downloadBtn.addEventListener("click",downloadZip);let pubPath="pdfs-pub",privPath="pdfs-priv";window.location.hostname.includes(".webflow.io")&&(pubPath="pdfs-pub-staging",privPath="pdfs-priv-staging");const setAuthedTearSheet=async()=>{console.log("Setting private download");try{let e=firebase.storage().ref(),t=window.location.href.split("/"),n=t[t.length-1],l=e.child(`${privPath}/${n}`),d=e.child(`${pubPath}/${n}`),a=await l.getDownloadURL(),o=await d.getDownloadURL(),i=document.getElementById("tearSheet"),r=document.getElementById("downloadOptionsWrapper");i.addEventListener("click",()=>{"none"===r.style.display?r.style.display="block":"block"===r.style.display&&(r.style.display="none")}),document.getElementById("withPricing").addEventListener("click",()=>window.open(a,"_blank")),document.getElementById("withoutPricing").addEventListener("click",()=>window.open(o,"_blank")),document.getElementById("dropdownIcon").style.display="block",document.getElementById("downloadIcon").style.display="none",document.getElementById("tearSheet").style.display="flex",r.style.display="none"}catch(s){console.error(s)}},setPubTearSheet=async()=>{console.log("Setting public download");try{let e=firebase.storage().ref(),t=window.location.href.split("/"),n=t[t.length-1],l=n.split("?")[0],d=e.child(`${pubPath}/${l}`),a=await d.getDownloadURL();document.getElementById("tearSheet").addEventListener("click",()=>{window.open(a,"_blank")}),document.getElementById("dropdownIcon").style.display="none",document.getElementById("downloadIcon").style.display="block",document.getElementById("tearSheet").style.display="flex"}catch(o){console.error(o)}};setTimeout(()=>{let e=getCookies(),t=document.getElementById("tradeModalWrapper");e._hideTradeModal?t.style.display="none":window.location.href.includes("mode=")&&(t.style.display="none");let n=document.getElementById("tradeJoinBtn"),l=document.getElementById("tradeDismissBtn");[n,l].forEach(e=>{e&&e.addEventListener("click",()=>{let e=new Date;e.setMonth(e.getMonth()+1),e.toUTCString(),document.cookie=`_hideTradeModal=true; expires=${e}; path=/`,t.style.display="none"})})},2e3);
