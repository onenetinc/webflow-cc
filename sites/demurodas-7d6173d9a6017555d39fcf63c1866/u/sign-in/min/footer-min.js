firebase.auth().onAuthStateChanged((e=>{e?window.location.replace("/"):document.getElementById("waitingContainer").style.display="none"}));const signInHeading=document.getElementById("signInHeading"),emailError=document.getElementById("emailError"),email=document.getElementById("email"),passwordError=document.getElementById("passwordError"),password=document.getElementById("password-2"),submitButton=document.getElementById("submit"),formError=document.getElementById("globalError"),urlParams=new URLSearchParams(window.location.search),emailAddress=urlParams.get("email");emailAddress&&(signInHeading.innerText="Please sign in with your new email address",email.value=emailAddress);const signInEmailPassword=async()=>{try{submitButton.value="Please wait...",submitButton.removeEventListener("click",signInEmailPassword),clearErrors(),await firebase.auth().signInWithEmailAndPassword(email.value,password.value),emailAddress?window.location.replace("/u/profile-settings?success=true"):window.location.replace("/")}catch(e){handleError(e)}};submitButton.addEventListener("click",signInEmailPassword),document.body.addEventListener("keyup",(e=>{13!==e.keyCode&&13!==e.which||submitButton.click()}));const handleError=e=>{if(e.code)switch(e.code){case"auth/user-not-found":emailError.classList.add("input_label_error"),emailError.innerText="Sorry, this account does not exist",email.classList.add("input_field_error");break;case"auth/wrong-password":passwordError.classList.add("input_label_error"),passwordError.innerText="Sorry, this password is incorrect",password.classList.add("input_field_error");break;default:formError.style.display="block"}else formError.style.display="block";submitButton.value="Submit",submitButton.addEventListener("click",signInEmailPassword),Sentry.captureException(e)},clearErrors=()=>{emailError.classList.remove("input_label_error"),emailError.innerText="Email address",email.classList.remove("input_field_error"),passwordError.classList.remove("input_label_error"),passwordError.innerText="Password",password.classList.remove("input_field_error"),formError.style.display="none"};