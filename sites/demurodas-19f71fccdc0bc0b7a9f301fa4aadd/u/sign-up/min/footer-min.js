firebase.auth().onAuthStateChanged((e=>{e?window.location.replace("/"):document.getElementById("waitingContainer").style.display="none"}));const firstName=document.getElementById("firstName"),lastName=document.getElementById("lastName"),email=document.getElementById("email"),password1=document.getElementById("password1"),password2=document.getElementById("password2"),website=document.getElementById("website"),company=document.getElementById("company"),americas=document.getElementById("americas"),other=document.getElementById("other"),resale=document.getElementById("resale"),firstNameError=document.getElementById("firstNameError"),lastNameError=document.getElementById("lastNameError"),emailError=document.getElementById("emailError"),password1Error=document.getElementById("password1Error"),password2Error=document.getElementById("password2Error"),companyError=document.getElementById("companyError"),websiteError=document.getElementById("websiteError"),formError=document.getElementById("globalError"),submitButton=document.getElementById("submit");americas.checked=!0,formError.classList.add("global_error");const userSignUp=()=>{clearErrors(),validateForm()&&postData()};submitButton.addEventListener("click",userSignUp),document.body.addEventListener("keyup",(e=>{13!==e.keyCode&&13!==e.which||submitButton.click()}));const validateForm=()=>{let e=0;return validateString(firstName.value)||(firstNameError.classList.add("input_label_error"),firstNameError.innerText="Please enter a valid first name",firstName.classList.add("input_field_error"),e++),validateString(lastName.value)||(lastNameError.classList.add("input_label_error"),lastNameError.innerText="Please enter a valid last name",lastName.classList.add("input_field_error"),e++),validateEmail(email.value)||(emailError.classList.add("input_label_error"),emailError.innerText="Please enter a valid email",email.classList.add("input_field_error"),e++),validateString(company.value)||(companyError.classList.add("input_label_error"),companyError.innerText="Please enter a valid company name",company.classList.add("input_field_error"),e++),validateWebsite(website.value)||(websiteError.classList.add("input_label_error"),websiteError.innerText="Please enter a valid website",website.classList.add("input_field_error"),e++),password1.value.length<6&&(password1Error.classList.add("input_label_error"),password1Error.innerText="Password must have 6 characters",password1.classList.add("input_field_error")),password1.value!==password2.value&&(password2Error.classList.add("input_label_error"),password2Error.innerText="Passwords do not match",password2.classList.add("input_field_error"),e++),0===e&&(console.log("Validation passed"),!0)},clearErrors=()=>{firstNameError.classList.remove("input_label_error"),firstNameError.innerText="First name",firstName.classList.remove("input_field_error"),lastNameError.classList.remove("input_label_error"),lastNameError.innerText="Last name",lastName.classList.remove("input_field_error"),emailError.classList.remove("input_label_error"),emailError.innerText="Email address",email.classList.remove("input_field_error"),password1Error.classList.remove("input_label_error"),password1Error.innerText="Password",password1.classList.remove("input_field_error"),password2Error.classList.remove("input_label_error"),password2Error.innerText="Verify password",password2.classList.remove("input_field_error"),companyError.classList.remove("input_label_error"),companyError.innerText="Company",company.classList.remove("input_field_error"),websiteError.classList.remove("input_label_error"),websiteError.innerText="Website",website.classList.remove("input_field_error"),formError.style.display="none"},postData=async()=>{try{submitButton.removeEventListener("click",userSignUp),submitButton.value="Please wait...";const e={firstName:firstName.value,lastName:lastName.value,email:email.value,password:password1.value,company:company.value,americas:americas.checked,website:website.value,resale:resale.value},r=await fetch(signUpUrl,{method:"POST",body:JSON.stringify(e)});if(201!==r.status)throw r.status;window.localStorage.setItem("emailForSignIn",email.value),window.location.replace("/u/success")}catch(e){submitButton.value="Submit",submitButton.addEventListener("click",userSignUp),409===e?(emailError.classList.add("input_label_error"),emailError.innerText="Sorry, this email is taken",email.classList.add("input_field_error")):(formError.style.display="block",Sentry.captureException(e))}};